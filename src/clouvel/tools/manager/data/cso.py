# CSO Manager Data
# Chief Security Officer

CSO_DATA = {'emoji': 'üîí', 'title': 'Chief Security Officer', 'focus': ['Security', 'Authentication', 'Authorization', 'Vulnerabilities', 'Data Protection'], 'keywords': ['security', 'auth', 'permission', 'token', 'jwt', 'session', 'encrypt', 'password', 'sql', 'injection', 'xss', 'csrf', 'vulnerability', 'login', 'secret'], 'questions': ['Is auth/authz properly implemented?', 'Is sensitive data properly protected?', 'Did you consider OWASP Top 10 vulnerabilities?', 'Is input validation in place?', 'Is security logging applied?'], 'opinions': {'auth': "@CTO No compromise on auth security.\n‚Ä¢ **Token storage**: localStorage ‚ùå (XSS vulnerable) ‚Üí httpOnly cookies ‚úÖ\n‚Ä¢ **JWT structure**: Separate Access Token (15min) + Refresh Token (7 days)\n‚Ä¢ **Refresh Token**: Store in DB + rotation (issue new token on use)\n‚Ä¢ **Password**: bcrypt/argon2 hashing required, min 12 chars, strength check\n‚Ä¢ **Session invalidation**: Expire all sessions on password change\n‚Ä¢ **Login failure**: Lock for 30min after 5 failures (brute force prevention)\n‚Ä¢ Files: src/lib/auth/token.ts, src/middleware/auth.ts", 'payment': "@CFO Payment security requires PCI-DSS compliance.\n‚Ä¢ **Never do**: Store card numbers directly, manipulate payment amounts server-side\n‚Ä¢ **Allowed**: Store only PG tokens (Stripe customer_id, payment_method_id)\n‚Ä¢ **Webhook verification**: Always verify signature (stripe-signature)\n‚Ä¢ **Idempotency**: Use idempotency key for every payment request\n‚Ä¢ **Logging**: Record all payment attempts/success/failure (mask sensitive info)\n‚Ä¢ **Test mode**: Never hardcode production keys in code\n‚Ä¢ Files: src/lib/payment/stripe.ts, src/app/api/webhook/stripe/route.ts", 'api': "API security checklist:\n‚Ä¢ **Authentication**: Token verification on all endpoints (except explicit public)\n‚Ä¢ **Authorization**: Verify owner access (RLS or middleware)\n‚Ä¢ **Rate Limiting**: Auth - 10/min, General - 100/min, Unauth - 20/min\n‚Ä¢ **CORS**: Specify allowed domains (no *, localhost in production)\n‚Ä¢ **Input validation**: Schema validation with Zod/Yup, trust nothing\n‚Ä¢ **Error responses**: No stack trace exposure, only 500 for internal errors\n‚Ä¢ Files: src/middleware/rateLimit.ts, src/lib/validation/schemas.ts", 'database': "@CTO One DB security mistake = major incident.\n‚Ä¢ **SQL Injection**: Use parameter binding only, never string concatenation\n  - ‚ùå `SELECT * FROM users WHERE id = '${id}'`\n  - ‚úÖ `SELECT * FROM users WHERE id = $1` + [id]\n‚Ä¢ **ORM usage**: No raw queries, mandatory code review if unavoidable\n‚Ä¢ **Sensitive data**: Encrypted storage (AES-256), separate table for PII\n‚Ä¢ **Access control**: Enable RLS (Row Level Security), separate service accounts\n‚Ä¢ **Backup**: Encrypted + stored in different region, quarterly recovery tests\n‚Ä¢ Files: src/lib/db/client.ts, prisma/schema.prisma", 'ui': "Frontend security checklist:\n‚Ä¢ **XSS prevention**:\n  - Never use innerHTML/dangerouslySetInnerHTML\n  - Always escape user input\n  - Set CSP header: script-src 'self'\n‚Ä¢ **CSRF**: SameSite=Strict cookies, include CSRF token in forms\n‚Ä¢ **Sensitive info**:\n  - No API Keys, Secrets in client bundle\n  - Only NEXT_PUBLIC_ env vars exposed to client\n‚Ä¢ **Dependencies**: Run npm audit regularly, update vulnerable packages\n‚Ä¢ **Console logs**: No sensitive info output in production\n‚Ä¢ Files: next.config.js (headers), src/middleware.ts", 'feature': "New feature security checklist:\n‚Ä¢ **Auth check**: Does this feature require login? ‚Üí Apply middleware\n‚Ä¢ **Authz check**: Does user have access to this data? ‚Üí Owner/role check\n‚Ä¢ **Input validation**: Is there validation logic for all user input?\n‚Ä¢ **Sensitive data**: Handling PII, payment info? ‚Üí Encrypt/mask\n‚Ä¢ **Logging**: Are important actions audit logged?\n‚Ä¢ **Testing**: Tested permission bypass scenarios?\n‚Ä¢ Missing permission check ‚Üí Data breach, legal liability, service shutdown", 'performance': "@CTO Performance optimization connects to security:\n‚Ä¢ **DDoS prevention**: Rate limiting + WAF (CloudFlare) setup\n‚Ä¢ **Timeout**: 30 sec limit on API requests, prevent infinite wait\n‚Ä¢ **Caching**: Never cache sensitive data, verify cache invalidation logic\n‚Ä¢ **Logging**: Ensure performance logs don't include sensitive info\n‚Ä¢ **Dependencies**: Check if heavy libraries have vulnerabilities", 'launch': "Pre-launch security checklist:\n‚Ä¢ [ ] HTTPS enforced (HTTP ‚Üí HTTPS redirect)\n‚Ä¢ [ ] Environment variables organized (dev/prod separated)\n‚Ä¢ [ ] Error messages generalized (stack traces hidden)\n‚Ä¢ [ ] Log level adjusted (debug ‚Üí info)\n‚Ä¢ [ ] Rate limiting on sensitive endpoints\n‚Ä¢ [ ] Backup/recovery test completed\n‚Ä¢ [ ] Security headers set (X-Frame-Options, CSP, etc.)\n‚Ä¢ Files: vercel.json/nginx.conf, .env.production", 'default': "OWASP Top 10 checklist:\n1. **Injection**: Prevent SQL, NoSQL, OS command injection\n2. **Broken Auth**: Session management, password policies\n3. **Sensitive Data Exposure**: Encryption, HTTPS\n4. **XXE**: XML parser configuration\n5. **Broken Access Control**: Authorization logic\n6. **Security Misconfiguration**: Change default settings\n7. **XSS**: Input escaping, CSP\n8. **Insecure Deserialization**: No deserialization of untrusted data\n9. **Known Vulnerabilities**: Dependency updates\n10. **Insufficient Logging**: Audit logs, monitoring"}, 'checklist': ['Auth check', 'Authorization check (RLS etc)', 'Input validation', 'Sensitive data encryption', 'SQL Injection prevention', 'XSS prevention'], 'critical_patterns': ['Hardcoded secrets', 'Plaintext passwords', 'SQL string concatenation', 'Direct innerHTML assignment'], 'action_templates': [{'trigger': 'security|auth|login', 'actions': [{'id': 'cso-1', 'action': 'Review OWASP Top 10 checklist', 'depends': [], 'verify': 'No security vulnerabilities', 'phase': 'Design'}, {'id': 'cso-2', 'action': 'Check input validation logic', 'depends': [], 'verify': 'Input validation implemented', 'phase': 'Design'}, {'id': 'cso-3', 'action': 'Review auth/authz logic', 'depends': [], 'verify': 'Auth logic secure', 'phase': 'Design'}, {'id': 'cso-4', 'action': 'Verify sensitive data encryption', 'depends': [], 'verify': 'Encryption applied', 'phase': 'Verify'}, {'id': 'cso-5', 'action': 'Conduct security code review', 'depends': ['cso-1', 'cso-2', 'cso-3'], 'verify': 'Security review passed', 'phase': 'Verify'}]}]}
